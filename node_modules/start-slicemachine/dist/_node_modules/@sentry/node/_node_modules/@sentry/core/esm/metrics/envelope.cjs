"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const utils = require("./utils.cjs");
const envelope = require("../../../utils/esm/envelope.cjs");
const dsn = require("../../../utils/esm/dsn.cjs");
function createMetricEnvelope(metricBucketItems, dsn$1, metadata, tunnel) {
  const headers = {
    sent_at: (/* @__PURE__ */ new Date()).toISOString()
  };
  if (metadata && metadata.sdk) {
    headers.sdk = {
      name: metadata.sdk.name,
      version: metadata.sdk.version
    };
  }
  if (!!tunnel && dsn$1) {
    headers.dsn = dsn.dsnToString(dsn$1);
  }
  const item = createMetricEnvelopeItem(metricBucketItems);
  return envelope.createEnvelope(headers, [item]);
}
function createMetricEnvelopeItem(metricBucketItems) {
  const payload = utils.serializeMetricBuckets(metricBucketItems);
  const metricHeaders = {
    type: "statsd",
    length: payload.length
  };
  return [metricHeaders, payload];
}
exports.createMetricEnvelope = createMetricEnvelope;
//# sourceMappingURL=envelope.cjs.map
