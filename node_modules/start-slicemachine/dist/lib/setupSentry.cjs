"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const manager = require("@slicemachine/manager");
const constants = require("../constants.cjs");
const checkIsSentryEnabled = require("./checkIsSentryEnabled.cjs");
const sdk = require('./../_node_modules/@sentry/node/esm/sdk.cjs');
const exports$1 = require('./../_node_modules/@sentry/node/_node_modules/@sentry/core/esm/exports.cjs');
const setupSentry = async (manager$1) => {
  if (!checkIsSentryEnabled.checkIsSentryEnabled()) {
    return;
  }
  const sliceMachineVersion = await manager$1.versions.getRunningSliceMachineVersion();
  const sliceMachineConfig = await manager$1.project.getSliceMachineConfig();
  let userProfile;
  try {
    userProfile = await manager$1.user.getProfile();
  } catch {
  }
  const { environment, release } = manager.getEnvironmentInfo({
    name: "slice-machine-ui",
    version: sliceMachineVersion
  });
  sdk.init({
    dsn: constants.SENTRY_EXPRESS_DSN,
    release,
    environment,
    // Increase the default truncation length of 250 to 2500 (x10)
    // to have enough details in Sentry
    maxValueLength: 2500
  });
  if (userProfile) {
    exports$1.setUser({ id: userProfile.shortId });
  }
  exports$1.setTag("repository", sliceMachineConfig.repositoryName);
  exports$1.setContext("Repository Data", {
    name: sliceMachineConfig.repositoryName
  });
};
exports.setupSentry = setupSentry;
//# sourceMappingURL=setupSentry.cjs.map
