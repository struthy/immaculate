import path__default from "node:path";
import { checkIsTypeScriptProject } from "./checkIsTypeScriptProject.js";
import { readFile } from "./lib/fsLimit.js";
const readSliceTemplateLibrary = async (args) => {
  const isTypeScriptProject = await checkIsTypeScriptProject(args);
  const { templateIDs, templates: initialTemplates, dirName, componentFileNames } = args;
  const templates = templateIDs && templateIDs.length ? initialTemplates.filter((t) => templateIDs == null ? void 0 : templateIDs.includes(t.model.id)) : initialTemplates;
  const templatesPromises = templates.map(async (t) => {
    const { mocks, model, screenshotPaths } = t;
    const screenshotEntries = Object.entries(screenshotPaths);
    const screenshotPromises = screenshotEntries.map(([key, filePath]) => {
      return readFile(path__default.join(dirName, filePath)).then((data) => [key, data]);
    });
    const readScreenshots = await Promise.all(screenshotPromises);
    const screenshots = Object.fromEntries(readScreenshots);
    const fileName = isTypeScriptProject ? componentFileNames.ts : componentFileNames.js;
    const componentContentsTemplate = await readFile(path__default.join(dirName, model.name, fileName), "utf-8");
    return {
      mocks,
      model,
      componentContentsTemplate,
      screenshots
    };
  });
  const resolvedTemplates = await Promise.all(templatesPromises);
  return {
    templates: resolvedTemplates
  };
};
export {
  readSliceTemplateLibrary
};
//# sourceMappingURL=readSliceTemplateLibrary.js.map
