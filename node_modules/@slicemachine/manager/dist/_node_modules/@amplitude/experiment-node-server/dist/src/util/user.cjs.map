{"version":3,"file":"user.cjs","sources":["../../../../../../../../../node_modules/@amplitude/experiment-node-server/dist/src/util/user.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.convertUserToEvaluationContext = void 0;\nconst convertUserToEvaluationContext = (user) => {\n    var _a;\n    if (!user) {\n        return {};\n    }\n    const userGroups = user.groups;\n    const userGroupProperties = user.group_properties;\n    const context = {};\n    user = Object.assign({}, user);\n    delete user['groups'];\n    delete user['group_properties'];\n    if (Object.keys(user).length > 0) {\n        context['user'] = user;\n    }\n    const groups = {};\n    if (!userGroups) {\n        return context;\n    }\n    for (const groupType of Object.keys(userGroups)) {\n        const groupNames = userGroups[groupType];\n        if (groupNames.length > 0 && groupNames[0]) {\n            const groupName = groupNames[0];\n            const groupNameMap = {\n                group_name: groupName,\n            };\n            // Check for group properties\n            const groupProperties = (_a = userGroupProperties === null || userGroupProperties === void 0 ? void 0 : userGroupProperties[groupType]) === null || _a === void 0 ? void 0 : _a[groupName];\n            if (groupProperties && Object.keys(groupProperties).length > 0) {\n                groupNameMap['group_properties'] = groupProperties;\n            }\n            groups[groupType] = groupNameMap;\n        }\n    }\n    if (Object.keys(groups).length > 0) {\n        context['groups'] = groups;\n    }\n    return context;\n};\nexports.convertUserToEvaluationContext = convertUserToEvaluationContext;\n"],"names":["user"],"mappings":";;AACA,OAAO,eAAeA,KAAAA,WAAS,cAAc,EAAE,OAAO,KAAI,CAAE;AACtBA,KAAAA,UAAA,iCAAG;AACzC,MAAM,iCAAiC,CAACA,UAAS;AAC7C,MAAI;AACJ,MAAI,CAACA,OAAM;AACP,WAAO;EACV;AACD,QAAM,aAAaA,MAAK;AACxB,QAAM,sBAAsBA,MAAK;AACjC,QAAM,UAAU,CAAA;AAChB,EAAAA,QAAO,OAAO,OAAO,CAAE,GAAEA,KAAI;AAC7B,SAAOA,MAAK,QAAQ;AACpB,SAAOA,MAAK,kBAAkB;AAC9B,MAAI,OAAO,KAAKA,KAAI,EAAE,SAAS,GAAG;AAC9B,YAAQ,MAAM,IAAIA;AAAA,EACrB;AACD,QAAM,SAAS,CAAA;AACf,MAAI,CAAC,YAAY;AACb,WAAO;AAAA,EACV;AACD,aAAW,aAAa,OAAO,KAAK,UAAU,GAAG;AAC7C,UAAM,aAAa,WAAW,SAAS;AACvC,QAAI,WAAW,SAAS,KAAK,WAAW,CAAC,GAAG;AACxC,YAAM,YAAY,WAAW,CAAC;AAC9B,YAAM,eAAe;AAAA,QACjB,YAAY;AAAA,MAC5B;AAEY,YAAM,mBAAmB,KAAK,wBAAwB,QAAQ,wBAAwB,SAAS,SAAS,oBAAoB,SAAS,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS;AACzL,UAAI,mBAAmB,OAAO,KAAK,eAAe,EAAE,SAAS,GAAG;AAC5D,qBAAa,kBAAkB,IAAI;AAAA,MACtC;AACD,aAAO,SAAS,IAAI;AAAA,IACvB;AAAA,EACJ;AACD,MAAI,OAAO,KAAK,MAAM,EAAE,SAAS,GAAG;AAChC,YAAQ,QAAQ,IAAI;AAAA,EACvB;AACD,SAAO;AACX;AACAA,KAAA,UAAA,iCAAyC;;","x_google_ignoreList":[0]}