{"version":3,"file":"cache.cjs","sources":["../../../../../../../../../node_modules/@amplitude/experiment-node-server/dist/src/local/cache.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InMemoryFlagConfigCache = void 0;\nclass InMemoryFlagConfigCache {\n    constructor(store, flagConfigs = {}) {\n        this.store = store;\n        this.cache = flagConfigs;\n    }\n    getAllCached() {\n        return Object.assign({}, this.cache);\n    }\n    get(flagKey) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.cache[flagKey];\n        });\n    }\n    getAll() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return Object.assign({}, this.cache);\n        });\n    }\n    put(flagKey, flagConfig) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            this.cache[flagKey] = flagConfig;\n            yield ((_a = this.store) === null || _a === void 0 ? void 0 : _a.put(flagKey, flagConfig));\n        });\n    }\n    putAll(flagConfigs) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const key in flagConfigs) {\n                const flag = flagConfigs[key];\n                if (flag) {\n                    this.cache[key] = flag;\n                }\n            }\n            yield ((_a = this.store) === null || _a === void 0 ? void 0 : _a.putAll(flagConfigs));\n        });\n    }\n    delete(flagKey) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            delete this.cache[flagKey];\n            yield ((_a = this.store) === null || _a === void 0 ? void 0 : _a.delete(flagKey));\n        });\n    }\n    clear() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            this.cache = {};\n            yield ((_a = this.store) === null || _a === void 0 ? void 0 : _a.clear());\n        });\n    }\n}\nexports.InMemoryFlagConfigCache = InMemoryFlagConfigCache;\n"],"names":["this","cache"],"mappings":";;;AACA,IAAI,YAAaA,iBAAI,kBAAIA,gCAAK,aAAc,SAAU,SAAS,YAAY,GAAG,WAAW;AACrF,WAAS,MAAM,OAAO;AAAE,WAAO,iBAAiB,IAAI,QAAQ,IAAI,EAAE,SAAU,SAAS;AAAE,cAAQ,KAAK;AAAA,IAAE,CAAE;AAAA,EAAI;AAC5G,SAAO,KAAK,MAAM,IAAI,UAAU,SAAU,SAAS,QAAQ;AACvD,aAAS,UAAU,OAAO;AAAE,UAAI;AAAE,aAAK,UAAU,KAAK,KAAK,CAAC;AAAA,MAAE,SAAU,GAAP;AAAY,eAAO,CAAC;AAAA;IAAM;AAC3F,aAAS,SAAS,OAAO;AAAE,UAAI;AAAE,aAAK,UAAU,OAAO,EAAE,KAAK,CAAC;AAAA,MAAI,SAAQ,GAAP;AAAY,eAAO,CAAC;AAAA;IAAM;AAC9F,aAAS,KAAK,QAAQ;AAAE,aAAO,OAAO,QAAQ,OAAO,KAAK,IAAI,MAAM,OAAO,KAAK,EAAE,KAAK,WAAW,QAAQ;AAAA,IAAI;AAC9G,UAAM,YAAY,UAAU,MAAM,SAAS,cAAc,CAAE,CAAA,GAAG,KAAI,CAAE;AAAA,EAC5E,CAAK;AACL;AACA,OAAO,eAAeC,MAAAA,WAAS,cAAc,EAAE,OAAO,KAAI,CAAE;AAC7BA,MAAAA,UAAA,0BAAG;AAClC,MAAM,wBAAwB;AAAA,EAC1B,YAAY,OAAO,cAAc,IAAI;AACjC,SAAK,QAAQ;AACb,SAAK,QAAQ;AAAA,EAChB;AAAA,EACD,eAAe;AACX,WAAO,OAAO,OAAO,CAAE,GAAE,KAAK,KAAK;AAAA,EACtC;AAAA,EACD,IAAI,SAAS;AACT,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,aAAO,KAAK,MAAM,OAAO;AAAA,IACrC,CAAS;AAAA,EACJ;AAAA,EACD,SAAS;AACL,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,aAAO,OAAO,OAAO,CAAE,GAAE,KAAK,KAAK;AAAA,IAC/C,CAAS;AAAA,EACJ;AAAA,EACD,IAAI,SAAS,YAAY;AACrB,QAAI;AACJ,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,WAAK,MAAM,OAAO,IAAI;AACtB,aAAQ,KAAK,KAAK,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,SAAS,UAAU;AAAA,IACpG,CAAS;AAAA,EACJ;AAAA,EACD,OAAO,aAAa;AAChB,QAAI;AACJ,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,iBAAW,OAAO,aAAa;AAC3B,cAAM,OAAO,YAAY,GAAG;AAC5B,YAAI,MAAM;AACN,eAAK,MAAM,GAAG,IAAI;AAAA,QACrB;AAAA,MACJ;AACD,aAAQ,KAAK,KAAK,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,WAAW;AAAA,IAC/F,CAAS;AAAA,EACJ;AAAA,EACD,OAAO,SAAS;AACZ,QAAI;AACJ,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,aAAO,KAAK,MAAM,OAAO;AACzB,aAAQ,KAAK,KAAK,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,OAAO;AAAA,IAC3F,CAAS;AAAA,EACJ;AAAA,EACD,QAAQ;AACJ,QAAI;AACJ,WAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,WAAK,QAAQ;AACb,aAAQ,KAAK,KAAK,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAO;AAAA,IACpF,CAAS;AAAA,EACJ;AACL;AACAA,MAAA,UAAA,0BAAkC;;","x_google_ignoreList":[0]}