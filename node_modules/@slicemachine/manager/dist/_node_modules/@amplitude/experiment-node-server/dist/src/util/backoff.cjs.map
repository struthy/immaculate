{"version":3,"file":"backoff.cjs","sources":["../../../../../../../../../node_modules/@amplitude/experiment-node-server/dist/src/util/backoff.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.doWithBackoff = void 0;\nconst time_1 = require(\"./time\");\nfunction doWithBackoff(action, backoffPolicy) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let delay = backoffPolicy.min;\n        for (let i = 0; i < backoffPolicy.attempts; i++) {\n            try {\n                return yield action();\n            }\n            catch (e) {\n                yield (0, time_1.sleep)(delay);\n                delay = Math.min(delay * backoffPolicy.scalar, backoffPolicy.max);\n            }\n        }\n    });\n}\nexports.doWithBackoff = doWithBackoff;\n"],"names":["this","backoff","require$$0"],"mappings":";;;;;AACA,IAAI,YAAaA,iBAAI,kBAAIA,gCAAK,aAAc,SAAU,SAAS,YAAY,GAAG,WAAW;AACrF,WAAS,MAAM,OAAO;AAAE,WAAO,iBAAiB,IAAI,QAAQ,IAAI,EAAE,SAAU,SAAS;AAAE,cAAQ,KAAK;AAAA,IAAE,CAAE;AAAA,EAAI;AAC5G,SAAO,KAAK,MAAM,IAAI,UAAU,SAAU,SAAS,QAAQ;AACvD,aAAS,UAAU,OAAO;AAAE,UAAI;AAAE,aAAK,UAAU,KAAK,KAAK,CAAC;AAAA,MAAE,SAAU,GAAP;AAAY,eAAO,CAAC;AAAA;IAAM;AAC3F,aAAS,SAAS,OAAO;AAAE,UAAI;AAAE,aAAK,UAAU,OAAO,EAAE,KAAK,CAAC;AAAA,MAAI,SAAQ,GAAP;AAAY,eAAO,CAAC;AAAA;IAAM;AAC9F,aAAS,KAAK,QAAQ;AAAE,aAAO,OAAO,QAAQ,OAAO,KAAK,IAAI,MAAM,OAAO,KAAK,EAAE,KAAK,WAAW,QAAQ;AAAA,IAAI;AAC9G,UAAM,YAAY,UAAU,MAAM,SAAS,cAAc,CAAE,CAAA,GAAG,KAAI,CAAE;AAAA,EAC5E,CAAK;AACL;AACA,OAAO,eAAeC,QAAAA,WAAS,cAAc,EAAE,OAAO,KAAI,CAAE;AACvCA,QAAAA,UAAA,gBAAG;AACxB,MAAM,SAASC,KAAAA;AACf,SAAS,cAAc,QAAQ,eAAe;AAC1C,SAAO,UAAU,MAAM,QAAQ,QAAQ,aAAa;AAChD,QAAI,QAAQ,cAAc;AAC1B,aAAS,IAAI,GAAG,IAAI,cAAc,UAAU,KAAK;AAC7C,UAAI;AACA,eAAO,MAAM,OAAM;AAAA,MACtB,SACM,GAAP;AACI,kBAAU,OAAO,OAAO,KAAK;AAC7B,gBAAQ,KAAK,IAAI,QAAQ,cAAc,QAAQ,cAAc,GAAG;AAAA,MACnE;AAAA,IACJ;AAAA,EACT,CAAK;AACL;AACAD,QAAA,UAAA,gBAAwB;;","x_google_ignoreList":[0]}