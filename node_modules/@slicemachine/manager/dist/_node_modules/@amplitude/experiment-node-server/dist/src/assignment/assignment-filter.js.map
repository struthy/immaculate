{"version":3,"file":"assignment-filter.js","sources":["../../../../../../../../../node_modules/@amplitude/experiment-node-server/dist/src/assignment/assignment-filter.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InMemoryAssignmentFilter = void 0;\nconst cache_1 = require(\"../util/cache\");\nconst assignment_service_1 = require(\"./assignment-service\");\nclass InMemoryAssignmentFilter {\n    constructor(size, ttlMillis = assignment_service_1.DAY_MILLIS) {\n        this.cache = new cache_1.Cache(size, ttlMillis);\n    }\n    shouldTrack(assignment) {\n        if (Object.keys(assignment.results).length === 0) {\n            // Don't track empty assignments.\n            return false;\n        }\n        const canonicalAssignment = assignment.canonicalize();\n        const track = this.cache.get(canonicalAssignment) == undefined;\n        if (track) {\n            this.cache.put(canonicalAssignment, 0);\n        }\n        return track;\n    }\n}\nexports.InMemoryAssignmentFilter = InMemoryAssignmentFilter;\n"],"names":["require$$0","require$$1"],"mappings":";;;;;AACA,OAAO,eAAe,kBAAS,cAAc,EAAE,OAAO,KAAI,CAAE;AAC5B,iBAAA,2BAAG;AACnC,MAAM,UAAUA;AAChB,MAAM,uBAAuBC;AAC7B,MAAM,yBAAyB;AAAA,EAC3B,YAAY,MAAM,YAAY,qBAAqB,YAAY;AAC3D,SAAK,QAAQ,IAAI,QAAQ,MAAM,MAAM,SAAS;AAAA,EACjD;AAAA,EACD,YAAY,YAAY;AACpB,QAAI,OAAO,KAAK,WAAW,OAAO,EAAE,WAAW,GAAG;AAE9C,aAAO;AAAA,IACV;AACD,UAAM,sBAAsB,WAAW;AACvC,UAAM,QAAQ,KAAK,MAAM,IAAI,mBAAmB,KAAK;AACrD,QAAI,OAAO;AACP,WAAK,MAAM,IAAI,qBAAqB,CAAC;AAAA,IACxC;AACD,WAAO;AAAA,EACV;AACL;AACA,iBAAA,2BAAmC;","x_google_ignoreList":[0]}