"use strict";
const user = require("../../../../../../_virtual/user.cjs");
Object.defineProperty(user.__exports, "__esModule", { value: true });
user.__exports.convertUserToEvaluationContext = void 0;
const convertUserToEvaluationContext = (user2) => {
  var _a;
  if (!user2) {
    return {};
  }
  const userGroups = user2.groups;
  const userGroupProperties = user2.group_properties;
  const context = {};
  user2 = Object.assign({}, user2);
  delete user2["groups"];
  delete user2["group_properties"];
  if (Object.keys(user2).length > 0) {
    context["user"] = user2;
  }
  const groups = {};
  if (!userGroups) {
    return context;
  }
  for (const groupType of Object.keys(userGroups)) {
    const groupNames = userGroups[groupType];
    if (groupNames.length > 0 && groupNames[0]) {
      const groupName = groupNames[0];
      const groupNameMap = {
        group_name: groupName
      };
      const groupProperties = (_a = userGroupProperties === null || userGroupProperties === void 0 ? void 0 : userGroupProperties[groupType]) === null || _a === void 0 ? void 0 : _a[groupName];
      if (groupProperties && Object.keys(groupProperties).length > 0) {
        groupNameMap["group_properties"] = groupProperties;
      }
      groups[groupType] = groupNameMap;
    }
  }
  if (Object.keys(groups).length > 0) {
    context["groups"] = groups;
  }
  return context;
};
user.__exports.convertUserToEvaluationContext = convertUserToEvaluationContext;
module.exports = user.__exports;
//# sourceMappingURL=user.cjs.map
