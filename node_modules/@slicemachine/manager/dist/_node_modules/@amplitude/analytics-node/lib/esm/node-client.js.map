{"version":3,"file":"node-client.js","sources":["../../../../../../../../node_modules/@amplitude/analytics-node/lib/esm/node-client.js"],"sourcesContent":["import { __assign, __awaiter, __extends, __generator } from \"tslib\";\nimport { AmplitudeCore, Destination, returnWrapper, debugWrapper, getClientLogConfig, getClientStates, } from '@amplitude/analytics-core';\nimport { Context } from './plugins/context';\nimport { useNodeConfig } from './config';\nvar AmplitudeNode = /** @class */ (function (_super) {\n    __extends(AmplitudeNode, _super);\n    function AmplitudeNode() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AmplitudeNode.prototype.init = function (apiKey, options) {\n        if (apiKey === void 0) { apiKey = ''; }\n        return returnWrapper(this._init(__assign(__assign({}, options), { apiKey: apiKey })));\n    };\n    AmplitudeNode.prototype._init = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var nodeOptions;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // Step 0: Block concurrent initialization\n                        if (this.initializing) {\n                            return [2 /*return*/];\n                        }\n                        this.initializing = true;\n                        nodeOptions = useNodeConfig(options.apiKey, __assign({}, options));\n                        return [4 /*yield*/, _super.prototype._init.call(this, nodeOptions)];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, this.add(new Destination()).promise];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, this.add(new Context()).promise];\n                    case 3:\n                        _a.sent();\n                        this.initializing = false;\n                        return [4 /*yield*/, this.runQueuedFunctions('dispatchQ')];\n                    case 4:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return AmplitudeNode;\n}(AmplitudeCore));\nexport { AmplitudeNode };\nexport var createInstance = function () {\n    var client = new AmplitudeNode();\n    return {\n        init: debugWrapper(client.init.bind(client), 'init', getClientLogConfig(client), getClientStates(client, ['config'])),\n        add: debugWrapper(client.add.bind(client), 'add', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.plugins'])),\n        remove: debugWrapper(client.remove.bind(client), 'remove', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.plugins'])),\n        track: debugWrapper(client.track.bind(client), 'track', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        logEvent: debugWrapper(client.logEvent.bind(client), 'logEvent', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        identify: debugWrapper(client.identify.bind(client), 'identify', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        groupIdentify: debugWrapper(client.groupIdentify.bind(client), 'groupIdentify', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        setGroup: debugWrapper(client.setGroup.bind(client), 'setGroup', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        revenue: debugWrapper(client.revenue.bind(client), 'revenue', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        flush: debugWrapper(client.flush.bind(client), 'flush', getClientLogConfig(client), getClientStates(client, ['config.apiKey', 'timeline.queue.length'])),\n        setOptOut: debugWrapper(client.setOptOut.bind(client), 'setOptOut', getClientLogConfig(client), getClientStates(client, ['config'])),\n    };\n};\nexport default createInstance();\n//# sourceMappingURL=node-client.js.map"],"names":["AmplitudeNode","client"],"mappings":"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","x_google_ignoreList":[0]}