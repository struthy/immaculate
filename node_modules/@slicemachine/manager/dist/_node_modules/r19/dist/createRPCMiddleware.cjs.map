{"version":3,"file":"createRPCMiddleware.cjs","sources":["../../../../../../node_modules/r19/dist/createRPCMiddleware.js"],"sourcesContent":["import { Buffer } from \"node:buffer\";\nimport { handleRPCRequest } from \"./handleRPCRequest.js\";\nconst createRPCMiddleware = (args) => {\n  const fn = (req, res, next) => {\n    if (req.method !== \"POST\") {\n      res.statusCode = 405;\n      res.end();\n      return next();\n    }\n    const requestBodyChunks = [];\n    req.on(\"data\", (chunk) => {\n      requestBodyChunks.push(chunk);\n    });\n    req.on(\"end\", async () => {\n      const { body, headers, statusCode } = await handleRPCRequest({\n        procedures: args.procedures,\n        body: Buffer.concat(requestBodyChunks),\n        onError: args.onError\n      });\n      if (statusCode) {\n        res.statusCode = statusCode;\n      }\n      for (const headerName in headers) {\n        res.setHeader(headerName, headers[headerName]);\n      }\n      res.end(Buffer.from(body), \"binary\");\n      next();\n    });\n  };\n  fn._procedures = args.procedures;\n  return fn;\n};\nexport {\n  createRPCMiddleware\n};\n//# sourceMappingURL=createRPCMiddleware.js.map\n"],"names":["handleRPCRequest","Buffer"],"mappings":";;;;AAEK,MAAC,sBAAsB,CAAC,SAAS;AACpC,QAAM,KAAK,CAAC,KAAK,KAAK,SAAS;AAC7B,QAAI,IAAI,WAAW,QAAQ;AACzB,UAAI,aAAa;AACjB,UAAI,IAAG;AACP,aAAO,KAAI;AAAA,IACZ;AACD,UAAM,oBAAoB,CAAA;AAC1B,QAAI,GAAG,QAAQ,CAAC,UAAU;AACxB,wBAAkB,KAAK,KAAK;AAAA,IAClC,CAAK;AACD,QAAI,GAAG,OAAO,YAAY;AACxB,YAAM,EAAE,MAAM,SAAS,WAAY,IAAG,MAAMA,iBAAAA,iBAAiB;AAAA,QAC3D,YAAY,KAAK;AAAA,QACjB,MAAMC,YAAAA,OAAO,OAAO,iBAAiB;AAAA,QACrC,SAAS,KAAK;AAAA,MACtB,CAAO;AACD,UAAI,YAAY;AACd,YAAI,aAAa;AAAA,MAClB;AACD,iBAAW,cAAc,SAAS;AAChC,YAAI,UAAU,YAAY,QAAQ,UAAU,CAAC;AAAA,MAC9C;AACD,UAAI,IAAIA,YAAM,OAAC,KAAK,IAAI,GAAG,QAAQ;AACnC;IACN,CAAK;AAAA,EACL;AACE,KAAG,cAAc,KAAK;AACtB,SAAO;AACT;;","x_google_ignoreList":[0]}