import * as t from "io-ts"

import type { LegacyContentCtx } from "../../../LegacyContentCtx"
import {
	GroupContent,
	GroupItemContentType,
	GroupItemLegacy,
} from "../../GroupContent"
import { NestableContent } from "../../nestable"

export const RepeatableWidgetsLegacy = (ctx: LegacyContentCtx) => {
	return t.array(GroupItemLegacy(ctx))
}

const RepeatableWidget = t.tuple([
	t.string,
	t.union([NestableContent, GroupContent]),
])
const RepeatableWidgetsBlock = t.strict({
	__TYPE__: t.literal(GroupItemContentType),
	value: t.array(RepeatableWidget),
})

export const RepeatableWidgets = t.array(RepeatableWidgetsBlock)
