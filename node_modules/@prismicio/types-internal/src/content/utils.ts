import { isRight } from "fp-ts/lib/Either"

import { FieldContentType, FieldType } from "./fields"

type WithFieldType = WithContentType & { type: FieldType }
export function hasFieldContentType(obj: unknown): obj is WithFieldType {
	return (
		hasContentType(obj) &&
		obj.__TYPE__ === FieldContentType &&
		(obj as WithFieldType)?.type !== undefined &&
		typeof (obj as WithFieldType).type === "string" &&
		isRight(FieldType.decode((obj as WithFieldType).type))
	)
}

type WithContentType = { __TYPE__: string }
export function hasContentType(obj: unknown): obj is WithContentType {
	return typeof obj === "object" && obj !== null && "__TYPE__" in obj
}
